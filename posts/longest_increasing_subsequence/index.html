<!DOCTYPE html>
<html>

<head>
  <title> æœ€é•¿é€’å¢å­åºåˆ— (Longest Increasing Subsequence) &middot; crazy.ark </title>
  
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1">
<meta name="generator" content="Hugo 0.87.0" />


<link rel="stylesheet" href="https://blog.crazyark.xyz/css/vec.css">
<link rel="stylesheet" href="https://blog.crazyark.xyz/css/github.css">


<link rel="apple-touch-icon-precomposed" sizes="144x144" href="/apple-touch-icon-144-precomposed.png">
<link rel="shortcut icon" href="/favicon.ico">


<link href="" rel="alternate" type="application/rss+xml" title="crazy.ark" />

</head>

<body>
  <header>
  <nav>
    <ul>
      
      
      <li class="pull-left ">
        <a href="https://blog.crazyark.xyz/">/home/crazy.ark</a>
      </li>
      
      
      <li class="pull-left ">
        <a href="/about">~/about</a>
      </li>
      
      
      <li class="pull-left ">
        <a href="/contact">~/contact</a>
      </li>
      
      
      <li class="pull-left ">
        <a href="https://ericfu.me">~/external/coding husky</a>
      </li>
      
      
      <li class="pull-left current">
        <a href="/posts">~/posts</a>
      </li>
      
  
      <li class="pull-right"><a href=""><i class="fas fa-rss"></i></a></li>
    </ul>
  </nav>
</header>

  <div class="content toc">
    <nav id="TableOfContents">
  <ul>
    <li>
      <ul>
        <li><a href="#algorithms-for-lis">Algorithms for LIS</a></li>
        <li><a href="#atcoder-grand-contest-019c">AtCoder Grand Contest 019C</a></li>
        <li><a href="#æ€»ç»“">æ€»ç»“</a></li>
      </ul>
    </li>
  </ul>
</nav>
    
    <section class="post">
      <h1 class="post-title"><a href="https://blog.crazyark.xyz/posts/longest_increasing_subsequence/">æœ€é•¿é€’å¢å­åºåˆ— (Longest Increasing Subsequence)</a></h1>
      <span class="post-date">Sep 1, 2017 </span>
      <div class="post-content">
        <p>æœ€é•¿é€’å¢å­åºåˆ—ç®—æ³•ï¼ŒåŸæœ¬ä»¥ä¸ºå·²ç»è®°ä½äº†æœ€å¿«çš„ç®—æ³•ï¼Œçœ‹æ¥æ˜¯è®°æ€§å¤ªå·®ï¼Œä»Šå¤©ç¢°åˆ°ä¸€é“é¢˜ç›®åˆå¿˜è®°äº†æ€ä¹ˆåš ğŸ™„</p>
<p>ä¸‰ç§åšæ³•ï¼šDPï¼ŒSort + LCSï¼ŒDP + BSï¼Œæˆ‘åªè®°å¾—ç¬¬ä¸€ç§DPäº† &hellip;</p>
<p>ç„¶åå’±ä»¬é¡ºä¾¿æŠŠæŸé“é¢˜ç›®åšäº† ğŸ¤£</p>
<h3 id="algorithms-for-lis">Algorithms for LIS</h3>
<h4 id="dp">DP</h4>
<p>å¾ˆæ˜¾ç„¶ï¼Œä»¥ç¬¬iä¸ªå…ƒç´ ä¸ºç»“å°¾çš„æœ€é•¿é€’å¢å­åºåˆ—çš„é•¿åº¦æ˜¯ max{dp[j] + 1}, j &lt;  i &amp;&amp; arr[j] &lt; arr[i]ï¼Œæ‰€ä»¥DPç©ºé—´å¤æ‚åº¦ O(n)ï¼Œæ—¶é—´å¤æ‚åº¦ O(n^2)ã€‚</p>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-cpp" data-lang="cpp"><span style="color:#339;font-weight:bold">int</span> <span style="color:#06b;font-weight:bold">LIS</span>(vector<span style="color:#333">&lt;</span><span style="color:#339;font-weight:bold">int</span><span style="color:#333">&gt;</span> nums) {
    <span style="color:#339;font-weight:bold">int</span> n <span style="color:#333">=</span> nums.size();
    <span style="color:#339;font-weight:bold">int</span> dp[n];
    <span style="color:#339;font-weight:bold">int</span> res <span style="color:#333">=</span> <span style="color:#00d;font-weight:bold">0</span>;
    <span style="color:#080;font-weight:bold">for</span> (<span style="color:#339;font-weight:bold">int</span> i <span style="color:#333">=</span> <span style="color:#00d;font-weight:bold">0</span>; i <span style="color:#333">&lt;</span> n; <span style="color:#333">++</span> i) {
        dp[n] <span style="color:#333">=</span> <span style="color:#00d;font-weight:bold">1</span>;
        <span style="color:#080;font-weight:bold">for</span> (<span style="color:#339;font-weight:bold">int</span> j <span style="color:#333">=</span> <span style="color:#00d;font-weight:bold">0</span>; j <span style="color:#333">&lt;</span> i; <span style="color:#333">++</span> j) {
            <span style="color:#080;font-weight:bold">if</span> (nums[j] <span style="color:#333">&lt;</span> nums[i]) 
                dp[i] <span style="color:#333">=</span> max(dp[i], dp[j] <span style="color:#333">+</span> <span style="color:#00d;font-weight:bold">1</span>);
        }
        res <span style="color:#333">=</span> max(res, dp[i]);
    }
    <span style="color:#080;font-weight:bold">return</span> res;
}
</code></pre></div><h4 id="sort--lcs">Sort + LCS</h4>
<p>åŸæ•°ç»„çš„é€’å¢å­åºåˆ—ä¸€å®šæ˜¯<strong>æ’åºå</strong>æ•°ç»„å’ŒåŸæ¥æ•°ç»„çš„å…¬å…±å­åºåˆ—ï¼Œæ‰€ä»¥æ’å®Œåºæ‰¾æœ€é•¿å…¬å…±å­åºåˆ—å°±è¡Œäº†ã€‚</p>
<p>ç©ºé—´å¤æ‚åº¦ O(n^2)ï¼Œæ—¶é—´å¤æ‚åº¦ O(n^2)ã€‚</p>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-cpp" data-lang="cpp"><span style="color:#339;font-weight:bold">int</span> <span style="color:#06b;font-weight:bold">LCS</span>(vector<span style="color:#333">&lt;</span><span style="color:#339;font-weight:bold">int</span><span style="color:#333">&gt;</span> a, vector<span style="color:#333">&lt;</span><span style="color:#339;font-weight:bold">int</span><span style="color:#333">&gt;</span> b) {
    assert(a.size() <span style="color:#333">==</span> b.size());
    
    <span style="color:#339;font-weight:bold">int</span> n <span style="color:#333">=</span> a.size();
    <span style="color:#339;font-weight:bold">int</span> dp[n <span style="color:#333">+</span> <span style="color:#00d;font-weight:bold">1</span>][n <span style="color:#333">+</span> <span style="color:#00d;font-weight:bold">1</span>];
    <span style="color:#080;font-weight:bold">for</span> (<span style="color:#339;font-weight:bold">int</span> i <span style="color:#333">=</span> <span style="color:#00d;font-weight:bold">0</span>; i <span style="color:#333">&lt;</span> n; <span style="color:#333">++</span> i) {
        <span style="color:#080;font-weight:bold">for</span> (<span style="color:#339;font-weight:bold">int</span> j <span style="color:#333">=</span> <span style="color:#00d;font-weight:bold">0</span>; j <span style="color:#333">&lt;</span> n; <span style="color:#333">++</span> j) {
            <span style="color:#080;font-weight:bold">if</span> (i <span style="color:#333">==</span> <span style="color:#00d;font-weight:bold">0</span> <span style="color:#333">||</span> j <span style="color:#333">==</span> <span style="color:#00d;font-weight:bold">0</span>) 
                dp[i][j] <span style="color:#333">=</span> <span style="color:#00d;font-weight:bold">0</span>;
            <span style="color:#080;font-weight:bold">else</span> <span style="color:#080;font-weight:bold">if</span> (a[i <span style="color:#333">-</span> <span style="color:#00d;font-weight:bold">1</span>] <span style="color:#333">==</span> b[j <span style="color:#333">-</span> <span style="color:#00d;font-weight:bold">1</span>]) 
                dp[i][j] <span style="color:#333">=</span> dp[i <span style="color:#333">-</span> <span style="color:#00d;font-weight:bold">1</span>][j <span style="color:#333">-</span> <span style="color:#00d;font-weight:bold">1</span>] <span style="color:#333">+</span> <span style="color:#00d;font-weight:bold">1</span>;
            <span style="color:#080;font-weight:bold">else</span> dp[i][j] <span style="color:#333">=</span> max(dp[i <span style="color:#333">-</span> <span style="color:#00d;font-weight:bold">1</span>][j], dp[i][j <span style="color:#333">-</span> <span style="color:#00d;font-weight:bold">1</span>]);
        }
    }
    <span style="color:#080;font-weight:bold">return</span> dp[n][n];
}

<span style="color:#339;font-weight:bold">int</span> <span style="color:#06b;font-weight:bold">LIS</span>(vector<span style="color:#333">&lt;</span><span style="color:#339;font-weight:bold">int</span><span style="color:#333">&gt;</span> nums) {
    <span style="color:#080;font-weight:bold">auto</span> sorted <span style="color:#333">=</span> nums;
    sort(sorted.begin(), sorted.end());
    <span style="color:#080;font-weight:bold">return</span> LCS(nums, sorted);
}
</code></pre></div><h4 id="dp--bs">DP + BS</h4>
<p>è¿™æ˜¯æœ€å¿«çš„ä¸€ä¸ªç®—æ³•ï¼Œä¹Ÿæ˜¯æˆ‘åˆ°ç°åœ¨éƒ½è¿˜æ²¡è®°ä½çš„ç®—æ³• ğŸ™„ï¼Œå…³é”®æ€æƒ³ä¸ºç»´æŠ¤ä¸€ä¸ªæ•°ç»„ï¼Œæ•°ç»„ä¸­ç¬¬lé¡¹(1-based) ä¸ºé•¿åº¦ä¸ºlçš„é€’å¢å­åºåˆ—çš„æœ€å¤§(æœ€å)å…ƒç´ çš„æœ€å°å€¼ï¼Œç„¶åä¸æ–­ç»´æŠ¤è¿™ä¸ªæ•°ç»„ç›´åˆ°ç»“æŸï¼Œæœ€ç»ˆæ•°ç»„çš„æœ‰æ•ˆé•¿åº¦å³ä¸ºLISçš„ç»“æœã€‚</p>
<p>ç”±äºç¬¬lé¡¹ä¸ºé•¿åº¦ä¸ºlçš„é€’å¢å­åºåˆ—çš„æœ€å¤§å…ƒç´ çš„æœ€å°å€¼ï¼Œæ‰€ä»¥è¯¥æ•°ç»„ä¸€å®šä¸ºä¸€ä¸ªé€’å¢æ•°ç»„ã€‚å½“ä¸‹ä¸€ä¸ªæ•°néœ€è¦èƒ½å¤Ÿæˆä¸ºæŸä¸ªé€’å¢å­åºåˆ—çš„ç»“å°¾æ—¶ï¼Œæˆ‘ä»¬åœ¨è¯¥æ•°ç»„ä¸­æŸ¥æ‰¾ç¬¬ä¸€ä¸ªä¸æ¯”nå°çš„æ•°ï¼Œå‡è®¾ä½ç½®ä¸ºlï¼Œé‚£ä¹ˆæˆ‘ä»¬å°±çŸ¥é“æˆ‘ä»¬èƒ½ä»¥nç»“å°¾æ„å»ºä¸€ä¸ªæœ€é•¿ä¸ºlçš„é€’å¢å­åºåˆ— (æƒ³æƒ³ä¸ºä»€ä¹ˆï¼Ÿå¾ˆç®€å•)ï¼Œæ­¤æ—¶æˆ‘ä»¬å°±å°†lä½ç½®çš„æ•°ç»„å€¼æ›´æ–°ä¸ºnã€‚æœ‰ä¸€ä¸ªç‰¹æ®Šæƒ…å†µå³æ•°ç»„ä¸­ä¸å­˜åœ¨ä½ç½®lï¼Œé‚£ä¹ˆå°±åœ¨æ•°ç»„æœ€åæ·»åŠ nã€‚</p>
<p>è¿™é‡ŒæŸ¥æ‰¾å¯ä»¥ä½¿ç”¨äºŒåˆ†æŸ¥æ‰¾çš„æ–¹å¼ï¼Œä»è€Œç©ºé—´å¤æ‚åº¦ä¸º O(n)ï¼Œæ—¶é—´å¤æ‚åº¦ä¸º O(nlgn)ã€‚</p>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-cpp" data-lang="cpp"><span style="color:#339;font-weight:bold">int</span> <span style="color:#06b;font-weight:bold">LIS</span>(vector<span style="color:#333">&lt;</span><span style="color:#339;font-weight:bold">int</span><span style="color:#333">&gt;</span> nums) {
    vector<span style="color:#333">&lt;</span><span style="color:#339;font-weight:bold">int</span><span style="color:#333">&gt;</span> dp;
    <span style="color:#080;font-weight:bold">for</span> (<span style="color:#080;font-weight:bold">auto</span> <span style="color:#970;font-weight:bold">n</span> : nums) {
        <span style="color:#080;font-weight:bold">auto</span> it <span style="color:#333">=</span> lower_bound(dp.begin(), dp.end(), n);
        <span style="color:#080;font-weight:bold">if</span> (it <span style="color:#333">==</span> dp.end()) dp.push_back(n);
        <span style="color:#080;font-weight:bold">else</span> <span style="color:#333">*</span>it <span style="color:#333">=</span> n;
    }
    <span style="color:#080;font-weight:bold">return</span> dp.size();
}
</code></pre></div><p>å…¶å®æˆ‘å‘ç°&hellip;ï¼Œæˆ‘éƒ½ä¸ç”¨æ‰‹å†™BSï¼ŒSTLè¿˜æ˜¯è§£å†³äº†å¾ˆå¤šé—®é¢˜çš„ï¼Œé™¤äº†æ²¡æœ‰Fibonacci Heapä¹‹å¤–æ„Ÿè§‰å¥½åƒä¹Ÿæ²¡å•¥ç¼ºç‚¹äº† (ç¬‘</p>
<h3 id="atcoder-grand-contest-019c">AtCoder Grand Contest 019C</h3>
<p>é¢˜ç›®ï¼š</p>
<blockquote>
<p>In the city of Nevermore, there are 10e8 streets and 10e8 avenues, both numbered from 0 to 10e8 âˆ’ 1. All streets run straight from west to east, and all avenues run straight from south to north. The distance between neighboring streets and between neighboring avenues is exactly 100 meters.
Every street intersects every avenue. Every intersection can be described by pair (x,y), where x is avenue ID and y is street ID.</p>
</blockquote>
<blockquote>
<p>There are N fountains in the city, situated at intersections (Xi,Yi). Unlike normal intersections, there&rsquo;s a circle with radius 10 meters centered at the intersection, and there are no road parts inside this circle.
The picture below shows an example of how a part of the city with roads and fountains may look like.</p>
</blockquote>
<p><img src="/img/posts/1f931bf0c98ec6f07e612b0282cdb094.png" alt="city"></p>
<p>çº¦æŸ:</p>
<blockquote>
<ul>
<li>0â‰¤x1,y1,x2,y2&lt;10e8</li>
</ul>
</blockquote>
<ul>
<li>1â‰¤Nâ‰¤200,000</li>
<li>0â‰¤Xi,Yi&lt;10e8</li>
<li>Xiâ‰ Xj for iâ‰ j</li>
<li>Yiâ‰ Yj for iâ‰ j</li>
<li>Intersections (x1,y1) and (x2,y2) are different and don&rsquo;t contain fountains.</li>
<li>All input values are integers.</li>
</ul>
<p>è¾“å…¥:</p>
<blockquote>
<p>x1 y1 x2 y2
N
X1 Y1
X2 Y2
:
XN YN</p>
</blockquote>
<p>è¾“å‡º:</p>
<blockquote>
<p>Print the shortest possible distance one needs to cover in order to get from intersection (x1,y1) to intersection (x2,y2), in meters. Your answer will be considered correct if its absolute or relative error doesn&rsquo;t exceed 10eâˆ’11.</p>
</blockquote>
<p>Samples:</p>
<blockquote>
<p>I: 1 1 6 5
3
3 2
5 3
2 4</p>
</blockquote>
<blockquote>
<p>O: 891.415926535897938</p>
</blockquote>
<!-- raw HTML omitted -->
<blockquote>
<p>I: 3 5 6 4
3
3 2
5 3
2 4</p>
</blockquote>
<blockquote>
<p>O: 400.000000000000000</p>
</blockquote>
<!-- raw HTML omitted -->
<blockquote>
<p>I: 4 2 2 2
3
3 2
5 3
2 4</p>
</blockquote>
<blockquote>
<p>O: 211.415926535897938</p>
</blockquote>
<p>Okï¼Œä¸€ä¸ªç½‘æ ¼ç»™å®šä¸¤ä¸ªç‚¹ï¼Œé‚£ä¹ˆä¸è€ƒè™‘å–·æ³‰çš„èµ°æ³•æ˜¯å›ºå®šçš„ï¼Œé•¿åº¦ä¸º abs(x1 - x2) + abs(y1 - y2)ã€‚</p>
<p>ç”±å¯¹ç§°æ€§ï¼Œæˆ‘ä»¬ä¸å¦¨è®¾ x1 &lt;= x2, y1 &lt;= y2ï¼Œè€ƒè™‘å–·æ³‰çš„æƒ…å†µä¸‹ï¼Œä»å–·æ³‰å¤„è½¬è§’èƒ½å¤Ÿå°‘èµ°ä¸€äº›è·¯ï¼Œè€Œç›´èµ°ç»è¿‡å–·æ³‰ä¼šå¤šèµ°ä¸€äº›è·¯ã€‚</p>
<p>å‡è®¾æˆ‘ä»¬çš„èµ°æ³•æ˜¯ç»•è¿œè·¯è´ªè½¬è§’å°‘èµ°ï¼Œæˆ–æ˜¯é¿å…ç›´èµ°ï¼Œå³èµ°å‡º{(x1, y1), (x2, y2)}æ‰€æ„æˆçš„çŸ©å½¢çš„æƒ…å†µï¼Œç”±äºæ¯è¡Œæ¯åˆ—ä»…æœ‰ä¸€ä¸ªå–·æ³‰ï¼Œæ‰€ä»¥å¤šè¿œç¦»çŸ©å½¢ä¸€æ ¼ä¼šå¯¼è‡´å¤šèµ°200mï¼Œè€Œæœ€å¤šåªèƒ½å°‘èµ° (2 * r - pi * r / 2) å¤§çº¦ä¸º4.5mçš„è·ç¦»ï¼Œæˆ–è€…å°‘èµ°(pi * r - 2 * r) å¤§çº¦ä¸º 11.4m çš„è·ç¦»ï¼Œæ‰€ä»¥æ˜¾ç„¶æ˜¯ä¸å¯èƒ½çš„ã€‚</p>
<p>æ‰€ä»¥èµ°æ³•ä¸€å®šæ˜¯åœ¨{(x1, y1), (x2, y2)}çŸ©å½¢å†…éƒ¨ï¼Œè´ªæœ€å¤šçš„è½¬è§’ã€‚</p>
<p>æ˜¾ç„¶ï¼Œåœ¨ (x1, y1) åˆ° (x2, y2) çš„è·¯ç¨‹ä¸­ï¼Œæœ€å¤šåªæœ‰ c = min(x2 - x1, y2 - y1) æ¬¡è½¬è§’ï¼Œæœ€å¤šæœ‰ c + 1 ä¸ªå–·æ³‰ã€‚</p>
<p>å‡è®¾å–·æ³‰æ˜¯æŒ‰ç…§xçš„å¤§å°è¿›è¡Œæ’åˆ—çš„ï¼Œé‚£ä¹ˆæˆ‘ä»¬èƒ½è¿‡çš„æœ€å¤šçš„æ¸©æ³‰ç­‰äºæ¸©æ³‰yå€¼æ•°ç»„çš„æœ€é•¿é€’å¢å­åºåˆ—ï¼Œå‡è®¾é•¿åº¦ä¸ºkã€‚</p>
<p>é‚£ä¹ˆæœ‰ä¸¤ç§æƒ…å†µï¼Œ</p>
<ol>
<li>k &lt;= c, é‚£ä¹ˆå°±ä¸€å®šæœ‰ä¸€ç§èµ°æ³•ï¼Œä½¿å¾—æˆ‘ä»¬ç»è¿‡è¿™ä¸ªå­åºåˆ—ä¸­æ¯ä¸ªæ¸©æ³‰çš„æ—¶å€™éƒ½æ˜¯è½¬è§’</li>
<li>k == c + 1ï¼Œé‚£ä¹ˆä¸€å®šå­˜åœ¨ä¸€ä¸ªå–·æ³‰éœ€è¦ç»è¿‡ï¼Œæ‰€ä»¥èµ°æ³•æ˜¯èµ°cä¸ªè§’ï¼Œå¹¶ç»è¿‡å‰©ä½™çš„ä¸€ä¸ªã€‚</li>
</ol>
<p>æ‰€ä»¥å…³é”®å³æ±‚æœ€é•¿é€’å¢å­åºåˆ—ï¼Œæ”¾ä»£ç </p>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-cpp" data-lang="cpp"><span style="color:#579">#include</span> <span style="color:#579">&lt;bits/stdc++.h&gt;</span><span style="color:#579">
</span><span style="color:#579"></span>
<span style="color:#080;font-weight:bold">using</span> <span style="color:#080;font-weight:bold">namespace</span> std;

pair<span style="color:#333">&lt;</span><span style="color:#339;font-weight:bold">long</span> <span style="color:#339;font-weight:bold">long</span>, <span style="color:#339;font-weight:bold">long</span> <span style="color:#339;font-weight:bold">long</span><span style="color:#333">&gt;</span> p[<span style="color:#00d;font-weight:bold">200000</span>];

<span style="color:#080;font-weight:bold">const</span> <span style="color:#339;font-weight:bold">double</span> PI <span style="color:#333">=</span> <span style="color:#60e;font-weight:bold">3.14159265358979323846</span>;
<span style="color:#080;font-weight:bold">const</span> <span style="color:#339;font-weight:bold">double</span> R <span style="color:#333">=</span> <span style="color:#60e;font-weight:bold">10.0</span>;
<span style="color:#080;font-weight:bold">const</span> <span style="color:#339;font-weight:bold">double</span> quarter_circle <span style="color:#333">=</span> PI <span style="color:#333">*</span> R <span style="color:#333">/</span> <span style="color:#00d;font-weight:bold">2</span>;
<span style="color:#080;font-weight:bold">const</span> <span style="color:#339;font-weight:bold">double</span> edge <span style="color:#333">=</span> <span style="color:#60e;font-weight:bold">100.0</span>;

<span style="color:#080;font-weight:bold">using</span> PLL <span style="color:#333">=</span> pair<span style="color:#333">&lt;</span><span style="color:#339;font-weight:bold">long</span> <span style="color:#339;font-weight:bold">long</span>, <span style="color:#339;font-weight:bold">long</span> <span style="color:#339;font-weight:bold">long</span><span style="color:#333">&gt;</span>;
<span style="color:#339;font-weight:bold">int</span> dp[<span style="color:#00d;font-weight:bold">200000</span>];

<span style="color:#339;font-weight:bold">int</span> <span style="color:#06b;font-weight:bold">main</span>() {
    <span style="color:#339;font-weight:bold">long</span> <span style="color:#339;font-weight:bold">long</span> x1, y1, x2, y2;
    scanf(<span style="background-color:#fff0f0">&#34;%lld %lld %lld %lld&#34;</span>, <span style="color:#333">&amp;</span>x1, <span style="color:#333">&amp;</span>y1, <span style="color:#333">&amp;</span>x2, <span style="color:#333">&amp;</span>y2);

    <span style="color:#080;font-weight:bold">if</span> (x1 <span style="color:#333">&gt;</span> x2) {
        swap(x1, x2);
        swap(y1, y2);
    }

    <span style="color:#339;font-weight:bold">long</span> <span style="color:#339;font-weight:bold">long</span> y_min <span style="color:#333">=</span> min(y1, y2), y_max <span style="color:#333">=</span> max(y1, y2);

    <span style="color:#888">// drop those not used
</span><span style="color:#888"></span>    <span style="color:#339;font-weight:bold">int</span> n;
    scanf(<span style="background-color:#fff0f0">&#34;%d&#34;</span>, <span style="color:#333">&amp;</span>n);
    <span style="color:#080;font-weight:bold">for</span> (<span style="color:#339;font-weight:bold">int</span> i <span style="color:#333">=</span> <span style="color:#00d;font-weight:bold">0</span>; i <span style="color:#333">&lt;</span> n;) {
        scanf(<span style="background-color:#fff0f0">&#34;%lld %lld&#34;</span>, <span style="color:#333">&amp;</span>p[i].first, <span style="color:#333">&amp;</span>p[i].second);
        <span style="color:#080;font-weight:bold">if</span> (p[i].first <span style="color:#333">&lt;</span> x1 <span style="color:#333">||</span> p[i].first <span style="color:#333">&gt;</span> x2 <span style="color:#333">||</span> p[i].second <span style="color:#333">&lt;</span> y_min <span style="color:#333">||</span> p[i].second <span style="color:#333">&gt;</span> y_max) {
            n<span style="color:#333">--</span>;
        } <span style="color:#080;font-weight:bold">else</span> {
            <span style="color:#333">++</span>i;
        }
    }

    <span style="color:#888">// x1 &lt;= x2
</span><span style="color:#888"></span>    <span style="color:#339;font-weight:bold">double</span> res <span style="color:#333">=</span> edge <span style="color:#333">*</span> (x2 <span style="color:#333">-</span> x1 <span style="color:#333">+</span> y_max <span style="color:#333">-</span> y_min);
    sort(p, p <span style="color:#333">+</span> n, [<span style="color:#333">&amp;</span>](<span style="color:#080;font-weight:bold">const</span> PLL<span style="color:#333">&amp;</span> a, <span style="color:#080;font-weight:bold">const</span> PLL<span style="color:#333">&amp;</span> b) { <span style="color:#080;font-weight:bold">return</span> a.first <span style="color:#333">&lt;</span> b.first; });
    <span style="color:#080;font-weight:bold">if</span> (y1 <span style="color:#333">&gt;</span> y2) {
        <span style="color:#080;font-weight:bold">for</span> (<span style="color:#339;font-weight:bold">int</span> i <span style="color:#333">=</span> <span style="color:#00d;font-weight:bold">0</span>; i <span style="color:#333">&lt;</span> n; <span style="color:#333">++</span>i) {
            p[i].second <span style="color:#333">=</span> <span style="color:#333">-</span>p[i].second;
        }
    }

    <span style="color:#339;font-weight:bold">int</span> len <span style="color:#333">=</span> <span style="color:#00d;font-weight:bold">0</span>;
    <span style="color:#080;font-weight:bold">for</span> (<span style="color:#339;font-weight:bold">int</span> i <span style="color:#333">=</span> <span style="color:#00d;font-weight:bold">0</span>; i <span style="color:#333">&lt;</span> n; <span style="color:#333">++</span>i) {
        <span style="color:#080;font-weight:bold">auto</span> it <span style="color:#333">=</span> lower_bound(dp, dp <span style="color:#333">+</span> len, p[i].second);
        <span style="color:#333">*</span>it <span style="color:#333">=</span> p[i].second;
        <span style="color:#080;font-weight:bold">if</span> (it <span style="color:#333">==</span> dp <span style="color:#333">+</span> len) {
            len <span style="color:#333">++</span>;
        }
    }

    <span style="color:#339;font-weight:bold">int</span> max_corner <span style="color:#333">=</span> min(x2 <span style="color:#333">-</span> x1, y_max <span style="color:#333">-</span> y_min);

    <span style="color:#080;font-weight:bold">if</span> (len <span style="color:#333">&lt;</span> max_corner <span style="color:#333">+</span> <span style="color:#00d;font-weight:bold">1</span>)
        res <span style="color:#333">+=</span> len <span style="color:#333">*</span> (quarter_circle <span style="color:#333">-</span> <span style="color:#00d;font-weight:bold">2</span> <span style="color:#333">*</span> R);
    <span style="color:#080;font-weight:bold">else</span>
        res <span style="color:#333">+=</span> max_corner <span style="color:#333">*</span> (quarter_circle <span style="color:#333">-</span> <span style="color:#00d;font-weight:bold">2</span> <span style="color:#333">*</span> R) <span style="color:#333">+</span> (<span style="color:#00d;font-weight:bold">2</span> <span style="color:#333">*</span> quarter_circle <span style="color:#333">-</span> <span style="color:#00d;font-weight:bold">2</span> <span style="color:#333">*</span> R);

    printf(<span style="background-color:#fff0f0">&#34;%.15f</span><span style="color:#666;background-color:#fff0f0;font-weight:bold">\n</span><span style="background-color:#fff0f0">&#34;</span>, res);

    <span style="color:#080;font-weight:bold">return</span> <span style="color:#00d;font-weight:bold">0</span>;
}
</code></pre></div><h3 id="æ€»ç»“">æ€»ç»“</h3>
<p>ä¸€å¤©ä¸åˆ·é¢˜å°±ä¼šå¿˜è®°ç®—æ³•ï¼Œè¿˜æœ‰ atcoder çš„é¢˜è¿˜çœŸæ˜¯éš¾&hellip;</p>
      </div>
    </section>
    
    <section class="pagination clearfix">
      
      <a class="btn previous " href="https://blog.crazyark.xyz/posts/cpp_sigfpe/"> SIGFPE When Doing DivQ </a> 
       
      
      <a class="btn next " href="https://blog.crazyark.xyz/posts/agc019_mysterious_combinators/"> ç¥å¥‡çš„ç»„åˆæ•° (AGC019-F Mysterious Combinators) </a> 
      
    </section>
    
    
<section id="disqus_thread" class='disqus'></section>
<script>
  var disqus_config = function () {
    this.page.url = "https://blog.crazyark.xyz/posts/longest_increasing_subsequence/";
    
  };
  (function() {
    var d = document, s = d.createElement('script');
    s.src = '//crazyark.disqus.com/embed.js';
    s.setAttribute('data-timestamp', +new Date());
    (d.head || d.body).appendChild(s);
  })();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript" rel="nofollow">comments powered by Disqus.</a></noscript>

  </div>
  
  <footer>
  <div class="footer-info">
    <p>
      <a href="mailto:arkbriar@gmail.com?subject="><i class="far fa-envelope"></i> arkbriar@gmail.com </a>
      {
        <a href="https://gohugo.io/" title="Hugo :: A fast and modern static website engine">Hugo 0.87.0</a>,
        <a href="https://github.com/IvanChou/yii.im" title="vec">Vec</a> 
      }
      {<a href="http://creativecommons.org/licenses/by-nc-nd/3.0/" title="CC BY-NC-ND 3.0">CC BY-NC-ND 3.0</a>}
    </p>
  </div>
</footer>


  <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>

<script type="text/x-mathjax-config">
MathJax.Hub.Config({
  tex2jax: {
    inlineMath: [['$','$']],
    displayMath: [['$$','$$']],
    processEscapes: true,
    processEnvironments: true,
    skipTags: ['script', 'noscript', 'style', 'textarea', 'pre'],
    TeX: { equationNumbers: { autoNumber: "AMS" },
         extensions: ["AMSmath.js", "AMSsymbols.js"] }
  }
});
</script>

<style type="text/css" media="screen">
  code.has-jax {
    font: inherit;
    font-size: 100%;
    background: inherit;
    border: inherit;
    color: #515151;
}
</style>

<script type="text/x-mathjax-config">
  MathJax.Hub.Queue(function() {
    // Fix <code> tags after MathJax finishes running. This is a
    // hack to overcome a shortcoming of Markdown. Discussion at
    // https://github.com/mojombo/jekyll/issues/199
    var all = MathJax.Hub.getAllJax();
    all.forEach(function(e) {
        e.SourceElement().parentNode.className += ' has-jax';
    });
});
</script>

  
  <script src="https://blog.crazyark.xyz/js/highlight.min.js"></script>
  <script>
    hljs.initHighlightingOnLoad();
  </script>
  

</body>

</html>
